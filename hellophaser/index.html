<!DOCTYPE html>
<head>
  <meta charset="UTF-8" />
  <title>hello phaser!</title>
  <script src="phaser.min.js"></script>
  <script src="queen.js"></script>
  <script src="king.js"></script>
  <!-- <script src="pawn.js"></script> -->
  <script src="bishop.js"></script>
  <script src="knight.js"></script>
  <script src='rooks.js'></script>
</head>
<body>

  <script type="text/javascript">
  

  window.onload = function() {
    window.game = new Phaser.Game(800, 800, Phaser.AUTO, '', { preload: preload, create: create, render: render, update: update});

    function preload () {
    
      game.load.image('square', 'grid.jpeg');
      game.load.image('bQueen', '/images/blackqueen.png');
      game.load.image('bKing', '/images/blackking.png');
      game.load.image('bRook', '/images/blackrook.png');
      game.load.image('bBishop', '/images/blackbishop.png');
      game.load.image('wBishop', '/images/whitebishop.png');
      game.load.image('bKnight', '/images/blackknight.png');
      game.load.image('wKnight', '/images/whiteknight.png');
  }

    var grid = [];
    var currentTile = new Phaser.Point();
    var bQueen;
    var bKing;
    var b1Rook;
    var b2Rook;
    var b1Bishop;
    var b2Bishop;
    var b1Knight;
    var b2Knight;
    
    function create () {
      game.physics.startSystem(Phaser.Physics.ARCADE);

        for (var y=0; y<8; y++) 
        {
          grid[y]= [];
          for (var x=0; x<8; x++){
            grid[y][x] = game.add.image(x * 100, y * 100, 'square');
          }
        }

        var allPieces = game.add.group();

        game.input.onDown.add(clickedBlock, this);
        // queen is added as sprite


        var b1Queen = makeQueen('black', 305, 5);
        allPieces.add(b1Queen);

        var b1King = makeKing('black', 405, 5);
        allPieces.add(b1King);

        var b1Rook = makeRook('black', 705, 5);
        allPieces.add(b1Rook);

        var b2Rook = makeRook('black', 5, 5);
        allPieces.add(b2Rook);

        var b1Bishop = makeBishop('black', 205, 5);
        allPieces.add(b1Bishop);

        var b2Bishop = makeBishop('black', 605, 5);
        allPieces.add(b2Bishop);

        var b1Knight = makeKnight('black', 105, 5);
        allPieces.add(b1Knight);

        var b2Knight = makeKnight('black', 505, 5);
        allPieces.add(b2Knight);

        allPieces.setAll('height', 90);
        allPieces.setAll('width', 90);
    }

    function clickedBlock() {
      if (currentTile.x >= 0 && currentTile.x <= 8 && currentTile.y >= 0 && currentTile.y <= 8)
      {
        square = grid[currentTile.y][currentTile.x];
        square.alpha = 0.5;
      }
      console.log("clicked!");
    }
    function update(){
      currentTile.x = this.game.math.snapToFloor(game.input.x, 100)/100;
      currentTile.y = this.game.math.snapToFloor(game.input.y, 100)/100;
    }

    function render() {
      game.debug.text('Tile X: ' + currentTile.x + 'Y: ' + currentTile.y, 5, 5);
    }
};

</script>

</body>
</html>